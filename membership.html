<!DOCTYPE html>
<html>
<head>
<title>Membership Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>

body{
    font-family:Arial;
    background:#EAEDED;
    padding:30px;
}

.container{
    max-width:900px;
    margin:auto;
}

.card{
    background:white;
    padding:25px;
    margin-bottom:20px;
    border-radius:8px;
    box-shadow:0 3px 10px rgba(0,0,0,0.1);
}

.plan{
    font-size:22px;
    font-weight:bold;
    color:#B12704;
}

.active{ color:green; font-weight:bold; }
.expired{ color:red; font-weight:bold; }

button{
    padding:10px 15px;
    border:none;
    border-radius:4px;
    cursor:pointer;
    font-weight:bold;
    margin:5px 5px 0 0;
}

.basic{ background:#f0c14b; }
.premium{ background:#FF9900; }
.save{ background:#4CAF50; color:white; }

.progress{
    width:100%;
    background:#ddd;
    border-radius:5px;
    margin-top:10px;
}

.progress-bar{
    height:12px;
    background:#4CAF50;
    border-radius:5px;
}

input, select{
    padding:8px;
    width:200px;
    margin-top:5px;
}

</style>
</head>
<body>

<div class="container">

<h2>Membership Dashboard</h2>

<!-- USER PROFILE -->
<div class="card">
    <h3>User Profile</h3>
    <p>Name: <span id="userName"></span></p>
    <p>Email: <span id="userEmail"></span></p>

    <button onclick="editProfile()">Edit Profile</button>
</div>

<!-- MEMBERSHIP STATUS -->
<div class="card">
    <h3>Status</h3>
    <p>Plan: <span id="planName" class="plan"></span></p>
    <p>Status: <span id="status"></span></p>
    <p>Expiry Date: <span id="expiryDate"></span></p>
    <p>Days Remaining: <span id="daysLeft"></span></p>

    <div class="progress">
        <div id="progressBar" class="progress-bar"></div>
    </div>
</div>

<!-- CHANGE PLAN -->
<div class="card">
    <h3>Change Plan</h3>
    <button class="basic" onclick="selectPlan('Basic',499)">Basic - ₹499</button>
    <button class="premium" onclick="selectPlan('Premium',999)">Premium - ₹999</button>
</div>

<!-- COUPON SYSTEM -->
<div class="card">
    <h3>Apply Coupon</h3>
    <input type="text" id="coupon" placeholder="Enter coupon code">
    <button class="save" onclick="applyCoupon()">Apply</button>
    <p id="couponMsg"></p>
</div>

<!-- PAYMENT METHOD -->
<div class="card">
    <h3>Payment Method</h3>
    <select id="paymentMethod">
        <option value="UPI">UPI</option>
        <option value="Card">Credit/Debit Card</option>
        <option value="Wallet">Wallet</option>
    </select>
</div>

<!-- AUTO RENEW -->
<div class="card">
    <h3>Auto Renewal</h3>
    <label>
        <input type="checkbox" id="autoRenew" onchange="toggleRenew()">
        Enable Auto Renewal
    </label>
</div>

<!-- BILLING -->
<div class="card">
    <button onclick="goBilling()">View Billing & Invoices</button>
</div>

</div>

<script>

// Default user profile
if(!localStorage.getItem("userName")){
    localStorage.setItem("userName","Guest User");
    localStorage.setItem("userEmail","guest@example.com");
}

// Default membership
if(!localStorage.getItem("plan")){
    localStorage.setItem("plan","Basic");
    localStorage.setItem("price",499);
    let expiry = new Date();
    expiry.setMonth(expiry.getMonth()+1);
    localStorage.setItem("expiry", expiry);
    localStorage.setItem("autoRenew","true");
}

loadData();

function loadData(){

    // Profile
    document.getElementById("userName").innerText = localStorage.getItem("userName");
    document.getElementById("userEmail").innerText = localStorage.getItem("userEmail");

    // Plan
    document.getElementById("planName").innerText = localStorage.getItem("plan");

    let expiry = new Date(localStorage.getItem("expiry"));
    document.getElementById("expiryDate").innerText = expiry.toDateString();

    let today = new Date();
    let diff = Math.ceil((expiry - today) / (1000*60*60*24));
    document.getElementById("daysLeft").innerText = diff + " days";

    // Progress bar
    let percent = Math.max(0, Math.min(100, (diff / 30) * 100));
    document.getElementById("progressBar").style.width = percent + "%";

    // Status
    if(today > expiry){
        document.getElementById("status").innerHTML = "Expired";
        document.getElementById("status").className="expired";

        if(localStorage.getItem("autoRenew") === "true"){
            renewPlan();
        }
    }else{
        document.getElementById("status").innerHTML = "Active";
        document.getElementById("status").className="active";
    }

    document.getElementById("autoRenew").checked =
        localStorage.getItem("autoRenew")==="true";
}

function editProfile(){
    let name = prompt("Enter your name:", localStorage.getItem("userName"));
    let email = prompt("Enter your email:", localStorage.getItem("userEmail"));

    if(name){
        localStorage.setItem("userName", name);
    }
    if(email){
        localStorage.setItem("userEmail", email);
    }

    loadData();
}

function selectPlan(plan,price){

    // Apply coupon discount
    let coupon = localStorage.getItem("discount") || 0;
    price = price - coupon;

    localStorage.setItem("plan",plan);
    localStorage.setItem("price",price);

    let expiry = new Date();
    expiry.setMonth(expiry.getMonth()+1);
    localStorage.setItem("expiry", expiry);

    generateInvoice(price);

    alert("Plan Updated to "+plan);
    loadData();
}

function applyCoupon(){
    let code = document.getElementById("coupon").value;

    if(code === "SAVE100"){
        localStorage.setItem("discount",100);
        document.getElementById("couponMsg").innerText = "₹100 discount applied!";
    }else{
        document.getElementById("couponMsg").innerText = "Invalid coupon.";
    }
}

function toggleRenew(){
    localStorage.setItem("autoRenew",
        document.getElementById("autoRenew").checked);
}

function renewPlan(){
    let expiry = new Date();
    expiry.setMonth(expiry.getMonth()+1);
    localStorage.setItem("expiry", expiry);

    generateInvoice(localStorage.getItem("price"));
}

function generateInvoice(amount){
    let invoices = JSON.parse(localStorage.getItem("invoices")||"[]");

    let id = "INV" + Math.floor(Math.random()*10000);

    invoices.push({
        id:id,
        amount:amount,
        date:new Date().toDateString(),
        method:document.getElementById("paymentMethod").value
    });

    localStorage.setItem("invoices", JSON.stringify(invoices));
}

function goBilling(){
    window.location="billing-advanced.html";
}

</script>

</body>
</html>